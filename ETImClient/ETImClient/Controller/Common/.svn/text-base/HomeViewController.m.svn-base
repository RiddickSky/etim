//
//  HomeViewController.m
//  HM-HEALTH
//
//  Created by xingyongdan on 14-5-6.
//  Copyright (c) 2014年 PingAn. All rights reserved.
//

#import "HomeViewController.h"
#import "YLAssetPickerViewController.h"
#import "PayAutoViewController.h"
#import "JKPedViewController.h"
#import "YLInferiorGoodsListViewController.h"
#import "JKLoginViewController.h"
#import "JKBloodPressureMainViewController.h"
#import "JKGlucoseMainViewController.h"
#import "JKTemperatureMainViewController.h"
#import "JKWeightMainViewController.h"
#import "JKQuickAskDoctorIndexViewController.h"
#import "YLReadPdfViewController.h"
#import "JKTestLoginViewController.h"

#import "HMLoadingView.h"
#import "HMAlertView.h"
#import "YLLoginViewController.h"
#import "JKSettingViewController.h"
#import "YLLoginViewController.h"
#import "JKOrderDoctorViewController.h"
#import "IndividualInfoViewController.h"
#import "JKWeightMainViewController.h"
#import "JKTemperatureMainViewController.h"
#import "JKGlucoseMainViewController.h"
#import "JKBloodPressureMainViewController.h"
#import "JKCompanyCodeViewController.h"

#define DEV_HOST_URL @"10.50.137.20:9001"
#define STG_HOST_URL @"egis-cssp-dmzstg1.pingan.com.cn"



@interface HomeViewController () {
    NSArray                 *_menuArr;
}

@end

@implementation HomeViewController

- (void)dealloc {
    [_menuArr release];
    
    [super dealloc];
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}


- (void)showLoading {
    [HMLoadingView showLoading:self.navigationController.view animated:YES message:@""];
}

- (void)hideLoading {
    [HMLoadingView hideLoading:self.view animated:YES];
}

- (void)viewDidLoad
{
    [super viewDidLoad];
	// Do any additional setup after loading the view.

    _menuArr = [[NSArray alloc] initWithObjects:@"JKPedViewController", @"JKLoginViewController",@"JKBloodPressureMainViewController",@"JKGlucoseMainViewController",@"JKTemperatureMainViewController",@"JKWeightMainViewController", @"JKQuickAskDoctorIndexViewController", @"PayAutoViewController", @"YLReadPdfViewController", @"YLInferiorGoodsListViewController",@"JKOrderDoctorViewController", @"YLMainWebViewController", @"YLLoginViewController", @"YLMainWebViewController",@"YLMainWebViewController",@"JKSettingViewController",@"IndividualInfoViewController", @"JKTestLoginViewController.h",@"JKCompanyCodeViewController", nil];
    
    NSArray *_menuTitleArr = [[[NSArray alloc] initWithObjects:@"计步器", @"活动室",
                              @"血压",@"血糖",@"体温",@"体重", @"120ask",@"自助理赔",
                              @"web view", @"问题件", @"预约挂号", @"PAWA", @"登录", @"保险", @"服务",@"设置",@"个人信息", @"测试网络请求",@"企业圈", nil] autorelease];

    
    for (int i = 0; i < [_menuArr count]; i++) {
        UIButton *btn = [UIButton buttonWithType:UIButtonTypeCustom];
        [btn setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
        btn.frame = CGRectMake(i % 2 * 150 + 10 + (i % 2) * 10, i / 2 * 50 + 20, 150, 30);
        [btn setTitle:[_menuTitleArr objectAtIndex:i] forState:UIControlStateNormal];
        [btn setBackgroundColor:[UIColor colorWithRed:140.0 / 255.0 green:110.0 / 255.0 blue:122.0 / 255.0 alpha:1.0]];
        [btn setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
        [btn addTarget:self action:@selector(responseToBtn:) forControlEvents:UIControlEventTouchUpInside];
        [self.view addSubview:btn];
        btn.tag = i;
    }
    
    /*
    UIButton* libraryBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [libraryBtn setTitle:@"photo library" forState:UIControlStateNormal];
    libraryBtn.frame = CGRectMake(100, 100, 100, 60);
    [libraryBtn addTarget:self action:@selector(photoLibAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:libraryBtn];
    
    UIButton* payBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [payBtn setTitle:@"自助理赔" forState:UIControlStateNormal];
    payBtn.frame = CGRectMake(100, 200, 100, 60);
    [payBtn addTarget:self action:@selector(payAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:payBtn];

    
    
    UIButton* libraryBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [libraryBtn setTitle:@"photo library" forState:UIControlStateNormal];
    libraryBtn.frame = CGRectMake(100, 100, 100, 60);
    [libraryBtn addTarget:self action:@selector(photoLibAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:libraryBtn];
    
    UIButton* payBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [payBtn setTitle:@"auto pay" forState:UIControlStateNormal];
    payBtn.frame = CGRectMake(100, 200, 100, 60);
    [payBtn addTarget:self action:@selector(payAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:payBtn];
    UIButton* webBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [webBtn setTitle:@"web view" forState:UIControlStateNormal];
    webBtn.frame = CGRectMake(100, 300, 100, 60);
    [webBtn addTarget:self action:@selector(webViewAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:webBtn];
    
    UIButton* webBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [webBtn setTitle:@"web view" forState:UIControlStateNormal];
    webBtn.frame = CGRectMake(100, 300, 100, 60);
    [webBtn addTarget:self action:@selector(webViewAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:webBtn];

    UIButton* inferiorBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [inferiorBtn setTitle:@"次品单" forState:UIControlStateNormal];
    inferiorBtn.frame = CGRectMake(100, 390, 100, 60);
    [inferiorBtn addTarget:self action:@selector(inferiorAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:inferiorBtn];

    
    UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    btn.frame = CGRectMake(0, 0, 80, 90);
    [btn setTitle:@"next" forState:UIControlStateNormal];
    [btn addTarget:self action:@selector(responseToBtn:) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:btn];
    
    self.view.backgroundColor = [UIColor blackColor];

    UIButton* loginBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [loginBtn setTitle:@"登录" forState:UIControlStateNormal];
    loginBtn.frame = CGRectMake(10, 100, 100, 60);
    [loginBtn addTarget:self action:@selector(loginClick) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:loginBtn];
    
    
    UIButton* webBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [webBtn setTitle:@"web view" forState:UIControlStateNormal];
    webBtn.frame = CGRectMake(100, 300, 100, 60);
    [webBtn addTarget:self action:@selector(webViewAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:webBtn];

    UIButton* inferiorBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [inferiorBtn setTitle:@"次品单" forState:UIControlStateNormal];
    inferiorBtn.frame = CGRectMake(100, 390, 100, 60);
    [inferiorBtn addTarget:self action:@selector(inferiorAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:inferiorBtn];
     */
    
     /*
    UIButton* inferiorBtn = [UIButton buttonWithType:UIButtonTypeCustom];
    [inferiorBtn setTitle:@"次品单" forState:UIControlStateNormal];
    inferiorBtn.frame = CGRectMake(100, 390, 100, 60);
    [inferiorBtn addTarget:self action:@selector(inferiorAction) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:inferiorBtn];

    
    UIButton *btn = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    btn.frame = CGRectMake(0, 0, 80, 90);
    [btn setTitle:@"next" forState:UIControlStateNormal];
    [btn addTarget:self action:@selector(responseToBtn:) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:btn];
      */
    
//    self.view.backgroundColor = [UIColor blackColor];

}

- (void)loginClick
{
    YLLoginViewController *loginVC = [[[YLLoginViewController alloc] init] autorelease];
    
    [self.navigationController pushViewController:loginVC animated:YES];
}

- (void)photoLibAction
{
    YLAssetPickerViewController *picker = [[[YLAssetPickerViewController alloc] init] autorelease];
    picker.maximumNumberOfSelection = 10;
    picker.assetsFilter = [ALAssetsFilter allPhotos];
    picker.showEmptyGroups=NO;
    picker.delegate=nil;
    picker.selectionFilter = [NSPredicate predicateWithBlock:^BOOL(id evaluatedObject, NSDictionary *bindings) {
        if ([[(ALAsset*)evaluatedObject valueForProperty:ALAssetPropertyType] isEqual:ALAssetTypeVideo]) {
            NSTimeInterval duration = [[(ALAsset*)evaluatedObject valueForProperty:ALAssetPropertyDuration] doubleValue];
            return duration >= 5;
        } else {
            return YES;
        }
    }];
    
    [self presentViewController:picker animated:YES completion:NULL];

}

- (void)payAction
{
    PayAutoViewController* payCon = [[[PayAutoViewController alloc] init] autorelease];
    [self.navigationController pushViewController:payCon animated:YES];
}

- (void)inferiorAction
{
    YLInferiorGoodsListViewController* inferiorCon = [[YLInferiorGoodsListViewController alloc] init];
    [self.navigationController pushViewController:inferiorCon animated:YES];
    [inferiorCon release];
}

- (void)responseToBtn:(UIButton *)sender {
    
    

    /*
    if ([sender.titleLabel.text isEqualToString:@"保险"]) {
        
        NSString *s = @"javasript:forward('financialMarket/insuranceHome/index')";
        
        [[MainWebView webView] stringByEvaluatingJavaScriptFromString:s];
        
        [self.navigationController pushViewController:MainWebView animated:YES];
    
        return;
    }else if([sender.titleLabel.text isEqualToString:@"服务"]) {
        
         NSString * s =  @"javasript:forward('#guaranteeSlip/guaranteeSlip/testHome')";
        
        [[MainWebView webView] stringByEvaluatingJavaScriptFromString:s];
        
        [self.navigationController pushViewController:MainWebView animated:YES];

        return;
    }
     */
    
    NSInteger tag = sender.tag;
    Class vcClass = NSClassFromString([_menuArr objectAtIndex:tag]);
    UIViewController *vc = [[vcClass alloc] init];
    if ([vc isKindOfClass:[JKSettingViewController class]]) {
        ((JKSettingViewController*)vc).titleList = [NSArray arrayWithObjects:@"消息通知",@"帮助",@"意见反馈",@"版本更新",@"关于我们", nil];
    }
    
    if ([sender.titleLabel.text isEqualToString:@"保险"]) {
        [(YLMainWebViewController *)vc startLoadWebViewWithUrlString:[NSString stringWithFormat:@"http://%@/m/insurance/index.html#financialMarket/insuranceHome/index", DEV_HOST_URL]];
    }
    else if([sender.titleLabel.text isEqualToString:@"服务"]) {
        [(YLMainWebViewController *)vc startLoadWebViewWithUrlString:[NSString stringWithFormat:@"http://%@/m/insurance/index.html#guaranteeSlip/guaranteeSlip/testHome", @"10.50.137.49:7007"]];
    }
    
    [self.navigationController pushViewController:vc animated:YES];
    
    [vc release];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end
