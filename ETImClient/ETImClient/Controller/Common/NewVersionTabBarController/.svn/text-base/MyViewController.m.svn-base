//
//  MyViewController.m
//  HM-HEALTH
//
//  Created by hujiwei on 14/7/16.
//  Copyright (c) 2014年 PingAn. All rights reserved.
//

#import "MyViewController.h"

#import "JKCompanyCodeViewController.h"
#import "JKSettingViewController.h"
#import "IndividualInfoViewController.h"
#import "BaseTabBarViewController.h"

@interface MyViewController ()

@end

@implementation MyViewController

- (void)dealloc
{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {
        
        self.title = @"我的";
        self.navigationItem.title = @"个人中心";
        
        [self.tabBarItem setFinishedSelectedImage:[UIImage imageNamed:@"tab_newMy_selected.png"] withFinishedUnselectedImage:[UIImage imageNamed:@"tab_newMy_unselected.png"]];
        [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(paySuccessPushMyOrder:) name:@"kJKHCKuaiQIanPaySuccessPushMyOrder" object:nil];
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    self.navigationItem.leftBarButtonItems = nil;
    self.view.backgroundColor = [UIColor colorWithRed:233.0 / 255.0 green:244.0 / 255.0 blue:248.0 / 255.0 alpha:1.0];
    self.tableView.backgroundColor = [UIColor clearColor];
    self.tableView.backgroundView = nil;
}

#pragma mark UITableViewDelegate
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    switch (indexPath.row) {
        case 0:
        {
            YLMainWebViewController *ylWebVC = [[YLMainWebViewController alloc] init];
            
            ylWebVC.hidesBottomBarWhenPushed = YES;
            [ylWebVC startLoadWebViewWithUrlString:[NSString stringWithFormat:@"%@/m/insurance/index.html", CSSP_HOST_URL]];
            ylWebVC.javascriptString = @"javascript:forward('#service/orderManager/insuranceOrder/index/2')";
            [self.navigationController pushViewController:ylWebVC animated:YES];
        }
            break;
            
        case 1 :
        {
            JKCompanyCodeViewController *vc=[[JKCompanyCodeViewController alloc] init];
            vc.hidesBottomBarWhenPushed = YES;
            
            [self.navigationController pushViewController:vc animated:YES];
        }
            break;
        case 2:
        {
            JKSettingViewController *vc = [[JKSettingViewController alloc] init];
            vc.hidesBottomBarWhenPushed = YES;
            
            [self.navigationController pushViewController:vc animated:YES];
        }
            break;
        case 3:
        {
            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"是否确定退出？" message:nil delegate:self cancelButtonTitle:@"取消" otherButtonTitles:@"确定", nil];
            
            [alert show];
            
        }
            break;
        case 1000:
        {
            IndividualInfoViewController *vc = [[IndividualInfoViewController alloc] init];
            vc.hidesBottomBarWhenPushed = YES;
            [self.navigationController pushViewController:vc animated:YES];
        }
            break;
        default:
            break;
    }
}

- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    return 5;
}

- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    UIView *headView=[[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 5)];
    headView.backgroundColor = [UIColor clearColor];
    return headView;
}

- (CGFloat)tableView:(UITableView *)tableView heightForFooterInSection:(NSInteger)section
{
    return 5;
}

- (UIView *)tableView:(UITableView *)tableView viewForFooterInSection:(NSInteger)section
{
    UIView *footerView=[[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 5)];
    footerView.backgroundColor = [UIColor clearColor];
    return footerView;
}


- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex == 1) {
        [BaseTabBarViewController jumpToLogin];
        /*
         [delegate.rootController showRootController:NO];
         
         JKAppDelegate *appDelegate = (JKAppDelegate *)[[UIApplication sharedApplication] delegate];
         
         [appDelegate.rootController dismissViewControllerAnimated:YES completion:^{
         [[NSHTTPCookieStorage sharedHTTPCookieStorage] deleteUserLoginCookie];
         
         [[NSUserDefaults standardUserDefaults] setValue:nil forKey:kTxtInfo];
         
         [[NSUserDefaults standardUserDefaults] synchronize];
         }];
         */
    }
}

- (IBAction)userTouchEvent:(id)sender {
    IndividualInfoViewController *ivc = [[IndividualInfoViewController alloc] init];
    ivc.hidesBottomBarWhenPushed = YES;
    ivc.viewController = @"JKPedViewController";
    [self.navigationController pushViewController:ivc animated:YES];
}

- (void)paySuccessPushMyOrder:(NSNotification *)notif
{
    YLMainWebViewController *ylWebVC = [[YLMainWebViewController alloc] init];
    
    ylWebVC.hidesBottomBarWhenPushed = YES;
    [ylWebVC startLoadWebViewWithUrlString:[NSString stringWithFormat:@"%@/m/insurance/index.html", CSSP_HOST_URL]];
    ylWebVC.javascriptString = @"javascript:forward('#service/orderManager/insuranceOrder/index/2')";
    [self.navigationController pushViewController:ylWebVC animated:YES];
}

@end
